{% extends "base.html" %}
{% load static %}

{% block page-title %}
  Coder Kai - {{ post.title }}
{% endblock %}

{% block css-stylesheet %}
    <link rel="stylesheet" href={% static "main_app/post_content.css" %}>
{% endblock %}


{% block mainbody %}
    <div class="container op-post">
        
        <br />

        <div class="row">
            <div class="col-2 op-info">
                <div class="row">
                    <div class="col profile-pic">
                        <img class="profile-picture rounded-circle" width="140" height="125" src={% static "main_app/images/cat.jpg" %}>
                        <div class="row">
                            <div class="col profile-info">
                                <p id="username">{{ post.author }}</p>
                                <p>Rank:<span id="rank"> Code Master</span></p>
                                <p id="coder-kai-points">Coder Kai Points: {{ post.author.coderkaipoints.points }}</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="col-10 post-body">
                <div class="row">
                    <div class="col">
                        <h2 id="post-title">{{ post.title }}</h2>
                        <div class="tag-list">Tags:
                            {% for tag in post.tags.all %}
                            <span><li class="tag">{{ tag }}</li></span>
                            {% endfor %}
                        </div>
                        <div class="post-author-op">Asked by&nbsp<span><a class="username" href="#">CatCoder1234</a></span>&nbspon Aug. 6, 2023, 6:32 p.m.</span></div>
                    </div>
                </div>
                <p style="white-space: pre-line" class="post-text">{{ post.body }}</p>
                <div class="post-options">
                    <button type="button" class="btn btn-outline-secondary btn-lg px-1" onclick="location.href='{% url "login" %}'">
                        Track
                    </button>
                    <button type="button" class="btn btn-outline-secondary btn-lg px-1" onclick="location.href='{% url "new_response" post.slug %}'">
                        <svg style="margin-right: 0.2rem;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-reply" viewBox="0 0 16 16">
                            <path d="M6.598 5.013a.144.144 0 0 1 .202.134V6.3a.5.5 0 0 0 .5.5c.667 0 2.013.005 3.3.822.984.624 1.99 1.76 2.595 3.876-1.02-.983-2.185-1.516-3.205-1.799a8.74 8.74 0 0 0-1.921-.306 7.404 7.404 0 0 0-.798.008h-.013l-.005.001h-.001L7.3 9.9l-.05-.498a.5.5 0 0 0-.45.498v1.153c0 .108-.11.176-.202.134L2.614 8.254a.503.503 0 0 0-.042-.028.147.147 0 0 1 0-.252.499.499 0 0 0 .042-.028l3.984-2.933zM7.8 10.386c.068 0 .143.003.223.006.434.02 1.034.086 1.7.271 1.326.368 2.896 1.202 3.94 3.08a.5.5 0 0 0 .933-.305c-.464-3.71-1.886-5.662-3.46-6.66-1.245-.79-2.527-.942-3.336-.971v-.66a1.144 1.144 0 0 0-1.767-.96l-3.994 2.94a1.147 1.147 0 0 0 0 1.946l3.994 2.94a1.144 1.144 0 0 0 1.767-.96v-.667z"/>
                        </svg>
                    Answer</button>
                </div>
            </div>
        </div>
    </div>
    <br />
    <div class="col-4 response-count">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-arrow-bar-down" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M1 3.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5zM8 6a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 0 1 .708-.708L7.5 12.293V6.5A.5.5 0 0 1 8 6z"/>
        </svg>
        <p>7 answers</p>
    </div>

    {% for response, replies in response_dictionary.items %}
    <div class="container response">
        <div class="row">
            <div class="col-2 op-info-response">
                    <div class="col profile-pic-response">
                        <img class="profile-picture rounded-circle" width="80" height="80" src={% static "main_app/images/cat.jpg" %}>
                        <div class="row">
                            <div class="col profile-info-response">
                                <p id="username">{{ response.author }}</p>
                                <p>Rank:<span id="rank"> Code Master</span></p>
                                <p id="coder-kai-points">Coder Kai Points: 7723</p>
                            </div>
                        </div>
                    </div>
            </div>
            <div class="col-10 post-body-response">
            <div class="response-text">
                <p style="white-space: pre-line">
                {{ response.body }}
                </p>
            </div>
            <div class="response-author">Answered by&nbsp<span><a class="username" href="#">{{ response.author }}</a></span>&nbspon {{ response.timestamp }}</span></div>
            <div class="post-options">
                <button id="reply-button" type="button" class="btn btn-outline-secondary btn-lg px-1" onclick="location.href='{% url "new_reply" post.slug response.id %}'">Reply</button>
            </div>
            </div>

            <div class="col-2">
            </div>
        </div>


    {% for reply in replies %}
        <div class="reply">
            <div class="col-2 op-info">
                <div class="row">
                    <div class="col profile-pic reply-op-info">
                        <img class="profile-picture rounded-circle" width="50" height="50" src={% static "main_app/images/cat.jpg" %}>
                        <div class="row">
                            <div class="col profile-info">
                                <p id="username-reply" class="reply-op-info">{{ reply.author }}</p>
                                <p class="reply-op-info">Rank:<span id="rank"> Code Master</span></p>
                                <p id="coder-kai-points" class="reply-op-info">Coder Kai Points: {{ post.author.coderkaipoints.points }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="response-text post-body">
                <p>{{ reply.body }}</p>
                <div class="post-author"><span><a class="username" href="#">{{ reply.author }} </a></span>{{ reply.timestamp }}</span></div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endfor %}
{% endblock%}